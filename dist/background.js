(()=>{"use strict";chrome.runtime.onInstalled.addListener(()=>{console.log("Frontend Toolbox extension installed"),chrome.storage.local.set({toolboxSettings:{autoEnable:!1,defaultTools:["imageDownloader","styleInspector","videoRecorder"],theme:"light"},recordings:[],savedStyles:[]}),chrome.contextMenus.create({id:"frontend-toolbox-parent",title:"Frontend Toolbox",contexts:["all"]}),chrome.contextMenus.create({id:"image-downloader",parentId:"frontend-toolbox-parent",title:"ðŸ–¼ï¸ ì´ë¯¸ì§€ ë‹¤ìš´ë¡œë”",contexts:["all"]}),chrome.contextMenus.create({id:"style-inspector",parentId:"frontend-toolbox-parent",title:"ðŸ” ìŠ¤íƒ€ì¼ ê²€ì‚¬ê¸°",contexts:["all"]}),chrome.contextMenus.create({id:"video-recorder",parentId:"frontend-toolbox-parent",title:"ðŸŽ¥ ë¹„ë””ì˜¤ ë…¹í™”ê¸°",contexts:["all"]})}),chrome.runtime.onMessage.addListener((e,o,t)=>{switch(e.action){case"getSettings":return chrome.storage.local.get(["toolboxSettings"],e=>{t(e.toolboxSettings||{})}),!0;case"saveSettings":return chrome.storage.local.set({toolboxSettings:e.settings},()=>{t({success:!0})}),!0;case"styleExtracted":console.log("Style extracted:",e.data),t({success:!0});break;case"recordingStarted":console.log("Recording started:",e.data),t({success:!0});break;case"recordingCompleted":console.log("Recording completed:",e.data),t({success:!0});break;default:t({error:"Unknown action"})}}),chrome.tabs.onUpdated.addListener((e,o,t)=>{"complete"===o.status&&t.url&&console.log(`Tab updated: ${t.url}`)}),chrome.contextMenus.onClicked.addListener((e,o)=>{if(o?.id)switch(e.menuItemId){case"image-downloader":chrome.tabs.sendMessage(o.id,{action:"openImageDownloader"});break;case"style-inspector":chrome.tabs.sendMessage(o.id,{action:"openStyleInspector"});break;case"video-recorder":chrome.tabs.sendMessage(o.id,{action:"openVideoRecorder"})}}),chrome.runtime.onMessage.addListener((e,o,t)=>{if("download"===e.action)return chrome.downloads.download({url:e.url,filename:e.filename,conflictAction:"uniquify"},e=>{chrome.runtime.lastError?(console.error("Download error:",chrome.runtime.lastError),t({error:chrome.runtime.lastError.message})):t(e?{success:!0,downloadId:e}:{error:"Download failed"})}),!0})})();