/*! For license information please see content.js.LICENSE.txt */
(()=>{"use strict";var e={540:(e,t,n)=>{n(869)},698:(e,t)=>{Symbol.for("react.transitional.element");Symbol.for("react.fragment")},848:(e,t,n)=>{n(698)},869:(e,t)=>{Symbol.for("react.transitional.element"),Symbol.for("react.portal"),Symbol.for("react.fragment"),Symbol.for("react.strict_mode"),Symbol.for("react.profiler"),Symbol.for("react.consumer"),Symbol.for("react.context"),Symbol.for("react.forward_ref"),Symbol.for("react.suspense"),Symbol.for("react.memo"),Symbol.for("react.lazy"),Symbol.iterator;var n={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},o=Object.assign,r={};function i(e,t,o){this.props=e,this.context=t,this.refs=r,this.updater=o||n}function s(){}function a(e,t,o){this.props=e,this.context=t,this.refs=r,this.updater=o||n}i.prototype.isReactComponent={},i.prototype.setState=function(e,t){if("object"!=typeof e&&"function"!=typeof e&&null!=e)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")},i.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")},s.prototype=i.prototype;var l=a.prototype=new s;l.constructor=a,o(l,i.prototype),l.isPureReactComponent=!0;Array.isArray,Object.prototype.hasOwnProperty;"function"==typeof reportError&&reportError}},t={};function n(o){var r=t[o];if(void 0!==r)return r.exports;var i=t[o]={exports:{}};return e[o](i,i.exports,n),i.exports}n(848),n(540);const o={LAYOUT:["display","position","top","right","bottom","left","z-index","float","clear","overflow","overflow-x","overflow-y","visibility"],TYPOGRAPHY:["font-family","font-size","font-weight","font-style","line-height","letter-spacing","text-align","text-decoration","text-transform","white-space","word-wrap","word-break"],COLORS:["color","background-color","background-image","background-position","background-repeat","background-size","border-color","box-shadow","text-shadow","opacity"],SPACING:["margin","margin-top","margin-right","margin-bottom","margin-left","padding","padding-top","padding-right","padding-bottom","padding-left","width","height","min-width","min-height","max-width","max-height"]},r=e=>new Promise(t=>{const n=new Image;n.onload=()=>{t({width:n.naturalWidth,height:n.naturalHeight})},n.onerror=()=>{t({width:0,height:0})},n.src=e}),i=async e=>{try{const t=(await fetch(e,{method:"HEAD"})).headers.get("content-length");return t?parseInt(t,10):0}catch{return 0}},s=e=>{try{return new URL(e),!0}catch{return!1}},a=e=>{if(e.id)return`#${e.id}`;if(e.className){const t=e.className.split(" ").filter(Boolean);if(t.length>0)return`.${t.join(".")}`}const t=e.tagName.toLowerCase(),n=e.parentElement;if(!n)return t;const o=Array.from(n.children).filter(e=>e.tagName.toLowerCase()===t);if(o.length>1){const n=o.indexOf(e)+1;return`${t}:nth-of-type(${n})`}return t};class l{static async collectImages(){const e=[],t=new Set,n=document.querySelectorAll("img");for(const o of n){const n=o.src||o.dataset.src;n&&s(n)&&!t.has(n)&&(t.add(n),e.push({url:n,src:n,alt:o.alt,width:o.naturalWidth||void 0,height:o.naturalHeight||void 0,type:"img"}))}const o=document.querySelectorAll("*");for(const n of o){const o=window.getComputedStyle(n).backgroundImage;if(o&&"none"!==o){const n=o.match(/url\(["']?(.*?)["']?\)/);if(n&&n[1]){const o=n[1];s(o)&&!t.has(o)&&(t.add(o),e.push({url:o,src:o,type:"background"}))}}}const a=document.querySelectorAll("svg");for(let t=0;t<a.length;t++){const n=a[t];if(n.outerHTML){const o=n.outerHTML,r=new Blob([o],{type:"image/svg+xml"}),i=URL.createObjectURL(r);n.setAttribute("data-svg-index",t.toString()),e.push({url:i,src:i,type:"svg",width:n.clientWidth||n.getBoundingClientRect().width||void 0,height:n.clientHeight||n.getBoundingClientRect().height||void 0,alt:`SVG-${t+1}`})}}for(const t of e)try{if("svg"===t.type)t.width||(t.width=100),t.height||(t.height=100),t.size=new Blob([t.src]).size;else{const e=await r(t.src);t.width||(t.width=e.width),t.height||(t.height=e.height);try{t.size=await i(t.src)}catch{t.size=0}}}catch(e){console.warn("Failed to get image metadata:",e),t.width||(t.width=100),t.height||(t.height=100),t.size||(t.size=0)}return e.filter(e=>e.width&&e.height&&e.width>=16&&e.height>=16)}static async downloadImage(e,t){try{let n,o=t||this.generateFilename(e);if("svg"===e.type){if(e.src.startsWith("blob:")){const t=await fetch(e.src);n=await t.blob()}else{const t=document.querySelector(`svg[data-url="${e.src}"]`);if(!t)throw new Error("SVG element not found");{const e=(new XMLSerializer).serializeToString(t);n=new Blob([e],{type:"image/svg+xml"})}}o.endsWith(".svg")||(o=o.replace(/\.(jpg|jpeg|png|gif|webp|bmp)$/i,".svg"),o.includes(".")||(o+=".svg"))}else{if(0===e.size||!e.src.startsWith("blob:"))try{const t=await chrome.runtime.sendMessage({action:"download",url:e.src,filename:o});if(t.error)throw new Error(t.error);return}catch(e){console.warn("Background download failed, trying fetch:",e)}try{const t=await fetch(e.src,{mode:"cors"});if(!t.ok)throw new Error(`HTTP ${t.status}`);n=await t.blob()}catch(t){try{const t=await chrome.runtime.sendMessage({action:"download",url:e.src,filename:o});if(t.error)throw new Error(t.error);return}catch(e){throw console.error("All download methods failed:",e),new Error(`다운로드 실패: ${t.message||t}`)}}}const r=URL.createObjectURL(n);if(chrome?.downloads)chrome.downloads.download({url:r,filename:o});else{const e=document.createElement("a");e.href=r,e.download=o,document.body.appendChild(e),e.click(),document.body.removeChild(e)}setTimeout(()=>URL.revokeObjectURL(r),1e3)}catch(e){throw console.error("Failed to download image:",e),e}}static async downloadImages(e){const t=e=>new Promise(t=>setTimeout(t,e));for(let n=0;n<e.length;n++)try{await this.downloadImage(e[n]),n<e.length-1&&await t(500)}catch(e){console.error(`Failed to download image ${n+1}:`,e)}}static generateFilename(e){if("svg"===e.type)return`${e.alt||"svg-image"}.svg`;if(e.src.startsWith("blob:"))return`${e.alt||"image"}.${"background"===e.type?"jpg":"png"}`;try{let t=new URL(e.src).pathname.split("/").pop()||"image";if(!t.includes(".")){let n=this.getImageExtension(e.src);return n||(n="background"===e.type?"jpg":"png"),`${t}.${n}`}return t}catch{return`${e.alt||"image"}.${"background"===e.type?"jpg":"png"}`}}static getImageExtension(e){const t=e.match(/\.(jpg|jpeg|png|gif|svg|webp|bmp)(\?|$)/i);return t?t[1].toLowerCase():null}}var c;class d{static createOverlay(){this.overlayElement||(this.overlayElement=document.createElement("div"),this.overlayElement.id="frontend-toolbox-overlay",this.overlayElement.style.cssText="\n      position: fixed;\n      top: 0;\n      left: 0;\n      width: 100%;\n      height: 100%;\n      background: rgba(0, 0, 0, 0.3);\n      z-index: 999999;\n      pointer-events: none;\n      display: none;\n    ",this.highlightElement=document.createElement("div"),this.highlightElement.id="frontend-toolbox-highlight",this.highlightElement.style.cssText="\n      position: absolute;\n      background: rgba(59, 130, 246, 0.2);\n      border: 2px solid #3b82f6;\n      pointer-events: none;\n      z-index: 1000000;\n      display: none;\n      transition: all 0.1s ease;\n      box-shadow: 0 0 0 1px rgba(59, 130, 246, 0.3);\n    ",this.infoElement=document.createElement("div"),this.infoElement.id="frontend-toolbox-info",this.infoElement.style.cssText="\n      position: fixed;\n      top: 20px;\n      right: 20px;\n      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);\n      color: white;\n      padding: 16px;\n      border-radius: 12px;\n      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;\n      font-size: 14px;\n      z-index: 1000001;\n      box-shadow: 0 10px 25px rgba(0, 0, 0, 0.2);\n      max-width: 300px;\n      display: none;\n    ",document.body.appendChild(this.overlayElement),document.body.appendChild(this.highlightElement),document.body.appendChild(this.infoElement))}static removeOverlay(){this.overlayElement&&(this.overlayElement.remove(),this.overlayElement=null),this.highlightElement&&(this.highlightElement.remove(),this.highlightElement=null),this.infoElement&&(this.infoElement.remove(),this.infoElement=null)}static startInspecting(){this.createOverlay(),this.overlayElement.style.display="block",document.body.style.cursor="crosshair",document.addEventListener("mouseover",this.handleMouseOver),document.addEventListener("keydown",this.handleKeyDown),document.addEventListener("click",this.preventClick,!0)}static stopInspecting(){this.removeOverlay(),document.body.style.cursor="",document.removeEventListener("mouseover",this.handleMouseOver),document.removeEventListener("keydown",this.handleKeyDown),document.removeEventListener("click",this.preventClick,!0)}static highlightTarget(e){if(!this.highlightElement)return;const t=e.getBoundingClientRect(),n=window.pageYOffset||document.documentElement.scrollTop,o=window.pageXOffset||document.documentElement.scrollLeft;this.highlightElement.style.display="block",this.highlightElement.style.top=`${t.top+n}px`,this.highlightElement.style.left=`${t.left+o}px`,this.highlightElement.style.width=`${t.width}px`,this.highlightElement.style.height=`${t.height}px`}static showHoverInfo(e){if(!this.infoElement)return;const t=a(e),n=window.getComputedStyle(e);this.infoElement.innerHTML=`\n      <div style="font-weight: 600; margin-bottom: 8px; font-size: 16px;">\n        ${t}\n      </div>\n      <div style="font-size: 12px; opacity: 0.9; margin-bottom: 12px;">\n        ${e.tagName.toLowerCase()}${e.className?"."+e.className.split(" ").join("."):""}\n      </div>\n      <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 8px; font-size: 12px;">\n        <div><strong>Width:</strong> ${Math.round(e.getBoundingClientRect().width)}px</div>\n        <div><strong>Height:</strong> ${Math.round(e.getBoundingClientRect().height)}px</div>\n        <div><strong>Display:</strong> ${n.display}</div>\n        <div><strong>Position:</strong> ${n.position}</div>\n      </div>\n      <div style="margin-top: 12px; padding-top: 12px; border-top: 1px solid rgba(255,255,255,0.2); font-size: 12px; text-align: center;">\n        <strong>Enter</strong>로 저장 • <strong>ESC</strong>로 종료\n      </div>\n    `,this.infoElement.style.display="block"}static showSaveToast(){const e=document.createElement("div");e.style.cssText="\n      position: fixed;\n      top: 50%;\n      left: 50%;\n      transform: translate(-50%, -50%);\n      background: linear-gradient(135deg, #10b981 0%, #059669 100%);\n      color: white;\n      padding: 16px 24px;\n      border-radius: 12px;\n      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;\n      font-size: 16px;\n      font-weight: 600;\n      z-index: 1000002;\n      box-shadow: 0 10px 25px rgba(0, 0, 0, 0.2);\n      animation: fadeInOut 2s ease-in-out;\n    ",e.textContent="✓ 스타일이 저장되었습니다!";const t=document.createElement("style");t.textContent="\n      @keyframes fadeInOut {\n        0% { opacity: 0; transform: translate(-50%, -50%) scale(0.8); }\n        20% { opacity: 1; transform: translate(-50%, -50%) scale(1); }\n        80% { opacity: 1; transform: translate(-50%, -50%) scale(1); }\n        100% { opacity: 0; transform: translate(-50%, -50%) scale(0.8); }\n      }\n    ",document.head.appendChild(t),document.body.appendChild(e),setTimeout(()=>{e.remove(),t.remove()},2e3)}static extractStyles(e){const t=window.getComputedStyle(e),n=a(e),r=(e=>{const t={layout:{},typography:{},colors:{},spacing:{},others:{}};for(let n=0;n<e.length;n++){const r=e[n],i=e.getPropertyValue(r);o.LAYOUT.includes(r)?t.layout[r]=i:o.TYPOGRAPHY.includes(r)?t.typography[r]=i:o.COLORS.includes(r)?t.colors[r]=i:o.SPACING.includes(r)?t.spacing[r]=i:t.others[r]=i}return t})(t);return{selector:n,computed:t,properties:r,tailwindClasses:this.extractTailwindClasses(e)}}static extractTailwindClasses(e){const t=Array.from(e.classList),n=[/^(m|p)(t|r|b|l|x|y)?-\d+$/,/^text-(xs|sm|base|lg|xl|2xl|3xl|4xl|5xl|6xl)$/,/^text-(left|center|right|justify)$/,/^font-(thin|extralight|light|normal|medium|semibold|bold|extrabold|black)$/,/^bg-(transparent|current|black|white|gray|red|yellow|green|blue|indigo|purple|pink)-?\d*$/,/^text-(transparent|current|black|white|gray|red|yellow|green|blue|indigo|purple|pink)-?\d*$/,/^border-(transparent|current|black|white|gray|red|yellow|green|blue|indigo|purple|pink)-?\d*$/,/^rounded(-none|-sm|-md|-lg|-xl|-2xl|-3xl|-full)?$/,/^shadow(-none|-sm|-md|-lg|-xl|-2xl|-inner)?$/,/^flex(-1|-auto|-initial|-none)?$/,/^grid(-cols-\d+)?$/,/^w-(\d+|auto|full|screen)$/,/^h-(\d+|auto|full|screen)$/,/^(min|max)-(w|h)-(\d+|auto|full|screen)$/];return t.filter(e=>n.some(t=>t.test(e)))}static generateCSS(e){const{properties:t}=e;let n=`${e.selector} {\n`;const o=["display","position","width","height","color","background-color","font-size","font-family"];return o.forEach(e=>{Object.entries(t).forEach(([t,o])=>{o[e]&&(n+=`  ${e}: ${o[e]};\n`)})}),Object.entries(t).forEach(([e,t])=>{Object.entries(t).forEach(([e,t])=>{!o.includes(e)&&t&&"initial"!==t&&"normal"!==t&&(n+=`  ${e}: ${t};\n`)})}),n+="}",n}static generateTailwindClasses(e){const{properties:t,tailwindClasses:n}=e,o=[...n||[]],r={display:e=>({block:"block",inline:"inline","inline-block":"inline-block",flex:"flex","inline-flex":"inline-flex",grid:"grid",hidden:"hidden"}[e]||null),"text-align":e=>({left:"text-left",center:"text-center",right:"text-right",justify:"text-justify"}[e]||null),"font-weight":e=>({100:"font-thin",200:"font-extralight",300:"font-light",400:"font-normal",500:"font-medium",600:"font-semibold",700:"font-bold",800:"font-extrabold",900:"font-black"}[e]||null)};return Object.entries(t).forEach(([e,t])=>{Object.entries(t).forEach(([e,t])=>{const n=r[e];if(n){const e=n(t);e&&!o.includes(e)&&o.push(e)}})}),o.join(" ")}}function h(){console.log("Frontend Toolbox content script loaded")}c=d,d.highlightElement=null,d.overlayElement=null,d.infoElement=null,d.handleMouseOver=e=>{e.preventDefault(),e.stopPropagation();const t=e.target;t&&!t.id?.includes("frontend-toolbox")&&(c.currentTarget=t,c.highlightTarget(t),c.showHoverInfo(t))},d.preventClick=e=>{e.preventDefault(),e.stopPropagation()},d.currentTarget=null,d.handleKeyDown=e=>{if("Escape"===e.key)c.stopInspecting();else if("Enter"===e.key&&c.currentTarget){e.preventDefault();const t=c.extractStyles(c.currentTarget);chrome.runtime.sendMessage({action:"styleExtracted",data:t}),c.showSaveToast()}},chrome.runtime.onMessage.addListener((e,t,n)=>{switch(e.action){case"ping":n({pong:!0});break;case"getImages":return l.collectImages().then(e=>{n({images:e})}).catch(e=>{n({error:e.message})}),!0;case"downloadImage":return l.downloadImage(e.data.image).then(()=>n({success:!0})).catch(e=>n({error:e.message})),!0;case"downloadImages":return l.downloadImages(e.data.images).then(()=>n({success:!0})).catch(e=>n({error:e.message})),!0;case"startStyleInspector":try{d.startInspecting(),n({success:!0})}catch(e){n({error:e.message})}break;case"stopStyleInspector":try{d.stopInspecting(),n({success:!0})}catch(e){n({error:e.message})}break;default:n({error:"Unknown action"})}}),"loading"===document.readyState?document.addEventListener("DOMContentLoaded",h):h()})();